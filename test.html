<body></body>
<script>
    function loadImage(src) {
        return new Promise(function (resolve) {
            const image = new Image();
            image.addEventListener(
                "load",
                () => {
                    console.log("test load");
                    resolve(image);
                },
                { once: true }
            );
            image.src = src;
        });
    }

    for (let orientation of [1, 2, 3, 4, 5, 6, 7, 8]) {
        const canvas = document.createElement("canvas");
        canvas.width = 160;
        canvas.height = 320;
        document.body.append(canvas);

        const ctx = canvas.getContext("2d");
        loadImage(
            `https://wpt.live/html/canvas/element/manual/imagebitmap//resources/squares_${orientation}.jpg`
        )
            .then(image => {
                console.log("image loaded:", image);
                createImageBitmap(image, { imageOrientation: "none" });
            })
            .then(imageBitmap => {
                ctx.drawImage(imageBitmap, 0, 0, 160, 320);
            });
    }
</script>
